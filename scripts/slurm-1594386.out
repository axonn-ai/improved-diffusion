
Lmod is automatically replacing "PrgEnv-cray/8.3.3" with "PrgEnv-amd/8.3.3".


Lmod is automatically replacing "cce/15.0.0" with "amd/5.6.0".


Due to MODULEPATH changes, the following have been reloaded:
  1) cray-mpich/8.1.23

srun -n 2 python image_train.py --image_size 32 --num_channels 128 --num_res_blocks 3 --learn_sigma True --dropout 0.3 --diffusion_steps 4000 --noise_schedule cosine --lr 1e-4 --batch_size 64 --deepspeed_config ./ds_config.json
[2024-01-25 14:47:12,075] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-01-25 14:47:12,075] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
[2024-01-25 14:47:19,763] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-01-25 14:47:19,763] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-01-25 14:47:19,763] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-01-25 14:47:19,763] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-01-25 14:47:19,776] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=1, local_rank=1, world_size=2, master_addr=100.64.170.30, master_port=29500
[2024-01-25 14:47:19,776] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=2, master_addr=100.64.170.30, master_port=29500
[2024-01-25 14:47:19,776] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[W socket.cpp:436] [c10d] The server socket cannot be initialized on [::]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier05406.hostmgmt2307.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier05406.hostmgmt2307.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
Logging to /tmp/openai-2024-01-25-14-47-19-801241
initialized deepspeed
creating model and diffusion...
creating data loader...
[2024-01-25 14:47:25,524] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.13.1, git-hash=unknown, git-branch=unknown
[2024-01-25 14:47:26,180] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-01-25 14:47:26,181] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-01-25 14:47:26,181] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-01-25 14:47:26,206] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2024-01-25 14:47:26,206] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2024-01-25 14:47:26,206] [INFO] [logging.py:96:log_dist] [Rank 0] Creating fp16 ZeRO stage 3 optimizer, MiCS is enabled False, Hierarchical params gather False
[2024-01-25 14:47:26,206] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float32 ZeRO stage 3 optimizer
[2024-01-25 14:47:26,266] [INFO] [utils.py:791:see_memory_usage] Stage 3 initialize beginning
[2024-01-25 14:47:26,268] [INFO] [utils.py:792:see_memory_usage] MA 0.2 GB         Max_MA 0.2 GB         CA 0.21 GB         Max_CA 0 GB 
[2024-01-25 14:47:26,268] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.62 GB, percent = 4.9%
[2024-01-25 14:47:26,270] [INFO] [stage3.py:128:__init__] Reduce bucket size 10000000
[2024-01-25 14:47:26,270] [INFO] [stage3.py:129:__init__] Prefetch bucket size 10000000
[2024-01-25 14:47:26,317] [INFO] [utils.py:791:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[2024-01-25 14:47:26,318] [INFO] [utils.py:792:see_memory_usage] MA 0.2 GB         Max_MA 0.2 GB         CA 0.21 GB         Max_CA 0 GB 
[2024-01-25 14:47:26,318] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.62 GB, percent = 4.9%
Parameter Offload: Total persistent parameters: 1428358 in 323 params
[2024-01-25 14:47:26,656] [INFO] [utils.py:791:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[2024-01-25 14:47:26,657] [INFO] [utils.py:792:see_memory_usage] MA 0.1 GB         Max_MA 0.2 GB         CA 0.21 GB         Max_CA 0 GB 
[2024-01-25 14:47:26,657] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.7 GB, percent = 4.9%
[2024-01-25 14:47:26,811] [INFO] [utils.py:791:see_memory_usage] Before creating fp16 partitions
[2024-01-25 14:47:26,811] [INFO] [utils.py:792:see_memory_usage] MA 0.1 GB         Max_MA 0.1 GB         CA 0.21 GB         Max_CA 0 GB 
[2024-01-25 14:47:26,812] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.7 GB, percent = 4.9%
[2024-01-25 14:47:26,970] [INFO] [utils.py:791:see_memory_usage] After creating fp16 partitions: 1
[2024-01-25 14:47:26,971] [INFO] [utils.py:792:see_memory_usage] MA 0.1 GB         Max_MA 0.1 GB         CA 0.1 GB         Max_CA 0 GB 
[2024-01-25 14:47:26,971] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.71 GB, percent = 4.9%
[2024-01-25 14:47:27,021] [INFO] [utils.py:791:see_memory_usage] Before creating fp32 partitions
[2024-01-25 14:47:27,022] [INFO] [utils.py:792:see_memory_usage] MA 0.1 GB         Max_MA 0.1 GB         CA 0.1 GB         Max_CA 0 GB 
[2024-01-25 14:47:27,022] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.71 GB, percent = 4.9%
[2024-01-25 14:47:27,072] [INFO] [utils.py:791:see_memory_usage] After creating fp32 partitions
[2024-01-25 14:47:27,072] [INFO] [utils.py:792:see_memory_usage] MA 0.2 GB         Max_MA 0.2 GB         CA 0.2 GB         Max_CA 0 GB 
[2024-01-25 14:47:27,073] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.71 GB, percent = 4.9%
[2024-01-25 14:47:27,125] [INFO] [utils.py:791:see_memory_usage] Before initializing optimizer states
[2024-01-25 14:47:27,126] [INFO] [utils.py:792:see_memory_usage] MA 0.2 GB         Max_MA 0.2 GB         CA 0.2 GB         Max_CA 0 GB 
[2024-01-25 14:47:27,126] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.71 GB, percent = 4.9%
[2024-01-25 14:47:27,727] [INFO] [utils.py:791:see_memory_usage] After initializing optimizer states
[2024-01-25 14:47:27,728] [INFO] [utils.py:792:see_memory_usage] MA 0.39 GB         Max_MA 0.59 GB         CA 0.6 GB         Max_CA 1 GB 
[2024-01-25 14:47:27,728] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.73 GB, percent = 4.9%
[2024-01-25 14:47:27,729] [INFO] [stage3.py:482:_setup_for_real_optimizer] optimizer state initialized
/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 2 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
[2024-01-25 14:47:27,907] [INFO] [utils.py:791:see_memory_usage] After initializing ZeRO optimizer
[2024-01-25 14:47:27,907] [INFO] [utils.py:792:see_memory_usage] MA 0.53 GB         Max_MA 0.54 GB         CA 0.6 GB         Max_CA 1 GB 
[2024-01-25 14:47:27,908] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 24.74 GB, percent = 4.9%
[2024-01-25 14:47:27,908] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2024-01-25 14:47:27,908] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-01-25 14:47:27,908] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-01-25 14:47:27,908] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0001], mom=[(0.9, 0.999)]
[2024-01-25 14:47:27,909] [INFO] [config.py:984:print] DeepSpeedEngine configuration:
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   amp_enabled .................. False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   amp_params ................... False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   bfloat16_enabled ............. False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   checkpoint_parallel_write_pipeline  False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   checkpoint_tag_validation_enabled  True
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   checkpoint_tag_validation_fail  False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ffe74032310>
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   communication_data_type ...... None
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   curriculum_enabled_legacy .... False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   curriculum_params_legacy ..... False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   data_efficiency_enabled ...... False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   dataloader_drop_last ......... False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   disable_allgather ............ False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   dump_state ................... False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   dynamic_loss_scale_args ...... None
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   eigenvalue_enabled ........... False
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   eigenvalue_gas_boundary_resolution  1
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-01-25 14:47:27,909] [INFO] [config.py:988:print]   eigenvalue_layer_num ......... 0
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   eigenvalue_max_iter .......... 100
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   eigenvalue_stability ......... 1e-06
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   eigenvalue_tol ............... 0.01
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   eigenvalue_verbose ........... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   elasticity_enabled ........... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   fp16_auto_cast ............... None
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   fp16_enabled ................. False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   fp16_master_weights_and_gradients  False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   global_rank .................. 0
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   grad_accum_dtype ............. None
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   gradient_accumulation_steps .. 1
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   gradient_clipping ............ 0.0
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   gradient_predivide_factor .... 1.0
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   graph_harvesting ............. False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   initial_dynamic_scale ........ 65536
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   load_universal_checkpoint .... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   loss_scale ................... 0
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   memory_breakdown ............. False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   mics_hierarchial_params_gather  False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   mics_shard_size .............. -1
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   optimizer_legacy_fusion ...... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   optimizer_name ............... None
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   optimizer_params ............. None
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   pld_enabled .................. False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   pld_params ................... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   prescale_gradients ........... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   scheduler_name ............... None
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   scheduler_params ............. None
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   seq_parallel_communication_data_type  torch.float32
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   sparse_attention ............. None
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   sparse_gradients_enabled ..... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   steps_per_print .............. 10
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   train_batch_size ............. 128
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   train_micro_batch_size_per_gpu  64
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   use_data_before_expert_parallel_  False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   use_node_local_storage ....... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   wall_clock_breakdown ......... False
[2024-01-25 14:47:27,910] [INFO] [config.py:988:print]   weight_quantization_config ... None
[2024-01-25 14:47:27,911] [INFO] [config.py:988:print]   world_size ................... 2
[2024-01-25 14:47:27,911] [INFO] [config.py:988:print]   zero_allow_untested_optimizer  False
[2024-01-25 14:47:27,911] [INFO] [config.py:988:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=10000000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1000000000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=10000000 param_persistence_threshold=100000 model_persistence_threshold=sys.maxsize max_live_parameters=1000000000 max_reuse_distance=1000000000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-01-25 14:47:27,911] [INFO] [config.py:988:print]   zero_enabled ................. True
[2024-01-25 14:47:27,911] [INFO] [config.py:988:print]   zero_force_ds_cpu_optimizer .. True
[2024-01-25 14:47:27,911] [INFO] [config.py:988:print]   zero_optimization_stage ...... 3
[2024-01-25 14:47:27,911] [INFO] [config.py:974:print_user_config]   json = {
    "train_batch_size": 128, 
    "zero_optimization": {
        "stage": 3, 
        "contiguous_gradients": true, 
        "stage3_max_live_parameters": 1.000000e+09, 
        "stage3_max_reuse_distance": 1.000000e+09, 
        "stage3_prefetch_bucket_size": 1.000000e+07, 
        "stage3_param_persistence_threshold": 1.000000e+05, 
        "reduce_bucket_size": 1.000000e+07, 
        "sub_group_size": 1.000000e+09
    }
}
training...
/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 2 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
----------------------
| loss    | 1.07     |
| loss_q0 | 1.18     |
| loss_q1 | 1.01     |
| loss_q2 | 0.992    |
| loss_q3 | 1.03     |
| mse     | 1        |
| mse_q0  | 1        |
| mse_q1  | 1.01     |
| mse_q2  | 0.987    |
| mse_q3  | 0.998    |
| samples | 128      |
| step    | 0        |
| vb      | 0.0671   |
| vb_q0   | 0.179    |
| vb_q1   | 0.00506  |
| vb_q2   | 0.0049   |
| vb_q3   | 0.028    |
----------------------
[2024-01-25 14:47:58,185] [INFO] [logging.py:96:log_dist] [Rank 0] step=10, skipped=0, lr=[9.55e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:47:58,186] [INFO] [timer.py:260:stop] epoch=0/micro_step=10/global_step=10, RunningAvgSamplesPerSec=270.9431534225554, CurrSamplesPerSec=270.23984746150046, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.949    |
| loss_q0 | 0.969    |
| loss_q1 | 0.916    |
| loss_q2 | 0.924    |
| loss_q3 | 0.989    |
| mse     | 0.922    |
| mse_q0  | 0.945    |
| mse_q1  | 0.911    |
| mse_q2  | 0.919    |
| mse_q3  | 0.912    |
| samples | 1.41e+03 |
| step    | 10       |
| vb      | 0.027    |
| vb_q0   | 0.0235   |
| vb_q1   | 0.00448  |
| vb_q2   | 0.00467  |
| vb_q3   | 0.0769   |
----------------------
[2024-01-25 14:48:02,975] [INFO] [logging.py:96:log_dist] [Rank 0] step=20, skipped=0, lr=[9.05e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:02,975] [INFO] [timer.py:260:stop] epoch=0/micro_step=20/global_step=20, RunningAvgSamplesPerSec=268.899988199058, CurrSamplesPerSec=271.0925698231213, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.767    |
| loss_q0 | 0.838    |
| loss_q1 | 0.741    |
| loss_q2 | 0.729    |
| loss_q3 | 0.762    |
| mse     | 0.746    |
| mse_q0  | 0.796    |
| mse_q1  | 0.738    |
| mse_q2  | 0.726    |
| mse_q3  | 0.729    |
| samples | 2.69e+03 |
| step    | 20       |
| vb      | 0.0209   |
| vb_q0   | 0.0425   |
| vb_q1   | 0.0037   |
| vb_q2   | 0.00365  |
| vb_q3   | 0.0333   |
----------------------
[2024-01-25 14:48:07,776] [INFO] [logging.py:96:log_dist] [Rank 0] step=30, skipped=0, lr=[8.55e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:07,776] [INFO] [timer.py:260:stop] epoch=0/micro_step=30/global_step=30, RunningAvgSamplesPerSec=268.09276164006286, CurrSamplesPerSec=271.74008720044463, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.603    |
| loss_q0 | 0.691    |
| loss_q1 | 0.576    |
| loss_q2 | 0.569    |
| loss_q3 | 0.585    |
| mse     | 0.591    |
| mse_q0  | 0.668    |
| mse_q1  | 0.573    |
| mse_q2  | 0.566    |
| mse_q3  | 0.566    |
| samples | 3.97e+03 |
| step    | 30       |
| vb      | 0.0116   |
| vb_q0   | 0.023    |
| vb_q1   | 0.00283  |
| vb_q2   | 0.00282  |
| vb_q3   | 0.0185   |
----------------------
[2024-01-25 14:48:12,557] [INFO] [logging.py:96:log_dist] [Rank 0] step=40, skipped=0, lr=[8.049999999999999e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:12,557] [INFO] [timer.py:260:stop] epoch=0/micro_step=40/global_step=40, RunningAvgSamplesPerSec=268.01329274603665, CurrSamplesPerSec=271.4445546101306, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.481    |
| loss_q0 | 0.595    |
| loss_q1 | 0.454    |
| loss_q2 | 0.438    |
| loss_q3 | 0.442    |
| mse     | 0.469    |
| mse_q0  | 0.564    |
| mse_q1  | 0.452    |
| mse_q2  | 0.436    |
| mse_q3  | 0.429    |
| samples | 5.25e+03 |
| step    | 40       |
| vb      | 0.0115   |
| vb_q0   | 0.0309   |
| vb_q1   | 0.00226  |
| vb_q2   | 0.00217  |
| vb_q3   | 0.013    |
----------------------
[2024-01-25 14:48:17,340] [INFO] [logging.py:96:log_dist] [Rank 0] step=50, skipped=0, lr=[7.55e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:17,341] [INFO] [timer.py:260:stop] epoch=0/micro_step=50/global_step=50, RunningAvgSamplesPerSec=267.9350732956686, CurrSamplesPerSec=270.8664826820716, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.378    |
| loss_q0 | 0.472    |
| loss_q1 | 0.359    |
| loss_q2 | 0.34     |
| loss_q3 | 0.342    |
| mse     | 0.372    |
| mse_q0  | 0.461    |
| mse_q1  | 0.357    |
| mse_q2  | 0.339    |
| mse_q3  | 0.332    |
| samples | 6.53e+03 |
| step    | 50       |
| vb      | 0.00601  |
| vb_q0   | 0.0114   |
| vb_q1   | 0.00179  |
| vb_q2   | 0.00175  |
| vb_q3   | 0.00948  |
----------------------
[2024-01-25 14:48:22,117] [INFO] [logging.py:96:log_dist] [Rank 0] step=60, skipped=0, lr=[7.05e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:22,117] [INFO] [timer.py:260:stop] epoch=0/micro_step=60/global_step=60, RunningAvgSamplesPerSec=267.94829596923955, CurrSamplesPerSec=269.8576055814141, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 1.49     |
| loss_q0 | 0.418    |
| loss_q1 | 0.282    |
| loss_q2 | 0.258    |
| loss_q3 | 5.76     |
| mse     | 0.3      |
| mse_q0  | 0.4      |
| mse_q1  | 0.281    |
| mse_q2  | 0.257    |
| mse_q3  | 0.256    |
| samples | 7.81e+03 |
| step    | 60       |
| vb      | 1.18     |
| vb_q0   | 0.0189   |
| vb_q1   | 0.0014   |
| vb_q2   | 0.0013   |
| vb_q3   | 5.51     |
----------------------
[2024-01-25 14:48:26,894] [INFO] [logging.py:96:log_dist] [Rank 0] step=70, skipped=0, lr=[6.55e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:26,894] [INFO] [timer.py:260:stop] epoch=0/micro_step=70/global_step=70, RunningAvgSamplesPerSec=267.9543931434332, CurrSamplesPerSec=271.36072461130993, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.256    |
| loss_q0 | 0.37     |
| loss_q1 | 0.227    |
| loss_q2 | 0.201    |
| loss_q3 | 0.21     |
| mse     | 0.249    |
| mse_q0  | 0.359    |
| mse_q1  | 0.226    |
| mse_q2  | 0.2      |
| mse_q3  | 0.195    |
| samples | 9.09e+03 |
| step    | 70       |
| vb      | 0.00745  |
| vb_q0   | 0.0113   |
| vb_q1   | 0.00113  |
| vb_q2   | 0.00101  |
| vb_q3   | 0.0152   |
----------------------
[2024-01-25 14:48:31,669] [INFO] [logging.py:96:log_dist] [Rank 0] step=80, skipped=0, lr=[6.05e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:31,669] [INFO] [timer.py:260:stop] epoch=0/micro_step=80/global_step=80, RunningAvgSamplesPerSec=267.97543150924247, CurrSamplesPerSec=272.17155493458705, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.889    |
| loss_q0 | 0.349    |
| loss_q1 | 0.185    |
| loss_q2 | 0.16     |
| loss_q3 | 2.53     |
| mse     | 0.205    |
| mse_q0  | 0.333    |
| mse_q1  | 0.184    |
| mse_q2  | 0.159    |
| mse_q3  | 0.153    |
| samples | 1.04e+04 |
| step    | 80       |
| vb      | 0.684    |
| vb_q0   | 0.015    |
| vb_q1   | 0.00092  |
| vb_q2   | 0.000807 |
| vb_q3   | 2.38     |
----------------------
[2024-01-25 14:48:36,495] [INFO] [logging.py:96:log_dist] [Rank 0] step=90, skipped=0, lr=[5.5499999999999994e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:36,495] [INFO] [timer.py:260:stop] epoch=0/micro_step=90/global_step=90, RunningAvgSamplesPerSec=267.6667869462551, CurrSamplesPerSec=271.1513074958787, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.196    |
| loss_q0 | 0.349    |
| loss_q1 | 0.16     |
| loss_q2 | 0.132    |
| loss_q3 | 0.132    |
| mse     | 0.184    |
| mse_q0  | 0.315    |
| mse_q1  | 0.159    |
| mse_q2  | 0.131    |
| mse_q3  | 0.119    |
| samples | 1.16e+04 |
| step    | 90       |
| vb      | 0.0125   |
| vb_q0   | 0.0338   |
| vb_q1   | 0.000806 |
| vb_q2   | 0.000662 |
| vb_q3   | 0.0124   |
----------------------
[2024-01-25 14:48:41,271] [INFO] [logging.py:96:log_dist] [Rank 0] step=100, skipped=0, lr=[5.05e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:41,271] [INFO] [timer.py:260:stop] epoch=0/micro_step=100/global_step=100, RunningAvgSamplesPerSec=267.708000484398, CurrSamplesPerSec=271.1304931014282, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.171    |
| loss_q0 | 0.324    |
| loss_q1 | 0.137    |
| loss_q2 | 0.108    |
| loss_q3 | 0.107    |
| mse     | 0.159    |
| mse_q0  | 0.288    |
| mse_q1  | 0.136    |
| mse_q2  | 0.108    |
| mse_q3  | 0.0966   |
| samples | 1.29e+04 |
| step    | 100      |
| vb      | 0.0122   |
| vb_q0   | 0.036    |
| vb_q1   | 0.000689 |
| vb_q2   | 0.000546 |
| vb_q3   | 0.0104   |
----------------------
[2024-01-25 14:48:46,111] [INFO] [logging.py:96:log_dist] [Rank 0] step=110, skipped=0, lr=[4.55e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:46,111] [INFO] [timer.py:260:stop] epoch=0/micro_step=110/global_step=110, RunningAvgSamplesPerSec=267.40893253221606, CurrSamplesPerSec=242.65220346827496, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.145    |
| loss_q0 | 0.27     |
| loss_q1 | 0.122    |
| loss_q2 | 0.0919   |
| loss_q3 | 0.0827   |
| mse     | 0.142    |
| mse_q0  | 0.262    |
| mse_q1  | 0.121    |
| mse_q2  | 0.0915   |
| mse_q3  | 0.0801   |
| samples | 1.42e+04 |
| step    | 110      |
| vb      | 0.0033   |
| vb_q0   | 0.00881  |
| vb_q1   | 0.000619 |
| vb_q2   | 0.000458 |
| vb_q3   | 0.00267  |
----------------------
[2024-01-25 14:48:50,830] [INFO] [logging.py:96:log_dist] [Rank 0] step=120, skipped=0, lr=[4.05e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:50,830] [INFO] [timer.py:260:stop] epoch=0/micro_step=120/global_step=120, RunningAvgSamplesPerSec=267.73370327442086, CurrSamplesPerSec=271.52074623951967, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.134    |
| loss_q0 | 0.286    |
| loss_q1 | 0.11     |
| loss_q2 | 0.0799   |
| loss_q3 | 0.0697   |
| mse     | 0.129    |
| mse_q0  | 0.271    |
| mse_q1  | 0.11     |
| mse_q2  | 0.0795   |
| mse_q3  | 0.0669   |
| samples | 1.55e+04 |
| step    | 120      |
| vb      | 0.00447  |
| vb_q0   | 0.0152   |
| vb_q1   | 0.000553 |
| vb_q2   | 0.000401 |
| vb_q3   | 0.00278  |
----------------------
[2024-01-25 14:48:55,673] [INFO] [logging.py:96:log_dist] [Rank 0] step=130, skipped=0, lr=[3.55e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:48:55,674] [INFO] [timer.py:260:stop] epoch=0/micro_step=130/global_step=130, RunningAvgSamplesPerSec=267.4622777858837, CurrSamplesPerSec=271.1807543668326, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.121    |
| loss_q0 | 0.261    |
| loss_q1 | 0.101    |
| loss_q2 | 0.0706   |
| loss_q3 | 0.0588   |
| mse     | 0.118    |
| mse_q0  | 0.25     |
| mse_q1  | 0.101    |
| mse_q2  | 0.0703   |
| mse_q3  | 0.0571   |
| samples | 1.68e+04 |
| step    | 130      |
| vb      | 0.00337  |
| vb_q0   | 0.011    |
| vb_q1   | 0.000513 |
| vb_q2   | 0.000355 |
| vb_q3   | 0.00172  |
----------------------
[2024-01-25 14:49:00,395] [INFO] [logging.py:96:log_dist] [Rank 0] step=140, skipped=0, lr=[3.0500000000000006e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:49:00,395] [INFO] [timer.py:260:stop] epoch=0/micro_step=140/global_step=140, RunningAvgSamplesPerSec=267.7273085386769, CurrSamplesPerSec=271.1573333117837, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.121    |
| loss_q0 | 0.262    |
| loss_q1 | 0.0937   |
| loss_q2 | 0.0664   |
| loss_q3 | 0.0539   |
| mse     | 0.117    |
| mse_q0  | 0.253    |
| mse_q1  | 0.0932   |
| mse_q2  | 0.0661   |
| mse_q3  | 0.0511   |
| samples | 1.8e+04  |
| step    | 140      |
| vb      | 0.00317  |
| vb_q0   | 0.00884  |
| vb_q1   | 0.000469 |
| vb_q2   | 0.000331 |
| vb_q3   | 0.00277  |
----------------------
[2024-01-25 14:49:05,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=150, skipped=0, lr=[2.5500000000000003e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:49:05,238] [INFO] [timer.py:260:stop] epoch=0/micro_step=150/global_step=150, RunningAvgSamplesPerSec=267.49468532499634, CurrSamplesPerSec=271.68081922606495, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.132    |
| loss_q0 | 0.301    |
| loss_q1 | 0.0912   |
| loss_q2 | 0.0618   |
| loss_q3 | 0.0476   |
| mse     | 0.119    |
| mse_q0  | 0.256    |
| mse_q1  | 0.0908   |
| mse_q2  | 0.0615   |
| mse_q3  | 0.0463   |
| samples | 1.93e+04 |
| step    | 150      |
| vb      | 0.013    |
| vb_q0   | 0.0453   |
| vb_q1   | 0.00046  |
| vb_q2   | 0.000305 |
| vb_q3   | 0.00137  |
----------------------
[2024-01-25 14:49:09,960] [INFO] [logging.py:96:log_dist] [Rank 0] step=160, skipped=0, lr=[2.0499999999999997e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:49:09,960] [INFO] [timer.py:260:stop] epoch=0/micro_step=160/global_step=160, RunningAvgSamplesPerSec=267.7224247661158, CurrSamplesPerSec=270.9325054363542, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.115    |
| loss_q0 | 0.274    |
| loss_q1 | 0.0864   |
| loss_q2 | 0.0563   |
| loss_q3 | 0.0447   |
| mse     | 0.109    |
| mse_q0  | 0.251    |
| mse_q1  | 0.0859   |
| mse_q2  | 0.056    |
| mse_q3  | 0.043    |
| samples | 2.06e+04 |
| step    | 160      |
| vb      | 0.00622  |
| vb_q0   | 0.0225   |
| vb_q1   | 0.000438 |
| vb_q2   | 0.000286 |
| vb_q3   | 0.00171  |
----------------------
[2024-01-25 14:49:14,805] [INFO] [logging.py:96:log_dist] [Rank 0] step=170, skipped=0, lr=[1.5500000000000004e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:49:14,805] [INFO] [timer.py:260:stop] epoch=0/micro_step=170/global_step=170, RunningAvgSamplesPerSec=267.51133332205086, CurrSamplesPerSec=237.75917308999598, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.121    |
| loss_q0 | 0.288    |
| loss_q1 | 0.0882   |
| loss_q2 | 0.0546   |
| loss_q3 | 0.042    |
| mse     | 0.11     |
| mse_q0  | 0.249    |
| mse_q1  | 0.0878   |
| mse_q2  | 0.0543   |
| mse_q3  | 0.0406   |
| samples | 2.19e+04 |
| step    | 170      |
| vb      | 0.0111   |
| vb_q0   | 0.0397   |
| vb_q1   | 0.000451 |
| vb_q2   | 0.000273 |
| vb_q3   | 0.00145  |
----------------------
[2024-01-25 14:49:19,524] [INFO] [logging.py:96:log_dist] [Rank 0] step=180, skipped=0, lr=[1.05e-05], mom=[(0.9, 0.999)]
[2024-01-25 14:49:19,525] [INFO] [timer.py:260:stop] epoch=0/micro_step=180/global_step=180, RunningAvgSamplesPerSec=267.72007037083563, CurrSamplesPerSec=271.46624084592435, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.103    |
| loss_q0 | 0.234    |
| loss_q1 | 0.082    |
| loss_q2 | 0.0525   |
| loss_q3 | 0.0397   |
| mse     | 0.1      |
| mse_q0  | 0.227    |
| mse_q1  | 0.0816   |
| mse_q2  | 0.0523   |
| mse_q3  | 0.0371   |
| samples | 2.32e+04 |
| step    | 180      |
| vb      | 0.00264  |
| vb_q0   | 0.00746  |
| vb_q1   | 0.000417 |
| vb_q2   | 0.000262 |
| vb_q3   | 0.00256  |
----------------------
[2024-01-25 14:49:24,295] [INFO] [logging.py:96:log_dist] [Rank 0] step=190, skipped=0, lr=[5.500000000000005e-06], mom=[(0.9, 0.999)]
[2024-01-25 14:49:24,296] [INFO] [timer.py:260:stop] epoch=0/micro_step=190/global_step=190, RunningAvgSamplesPerSec=267.7519884289619, CurrSamplesPerSec=270.72197379063573, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
----------------------
| loss    | 0.11     |
| loss_q0 | 0.27     |
| loss_q1 | 0.0811   |
| loss_q2 | 0.0512   |
| loss_q3 | 0.0373   |
| mse     | 0.101    |
| mse_q0  | 0.238    |
| mse_q1  | 0.0807   |
| mse_q2  | 0.0509   |
| mse_q3  | 0.0363   |
| samples | 2.44e+04 |
| step    | 190      |
| vb      | 0.00823  |
| vb_q0   | 0.0315   |
| vb_q1   | 0.000412 |
| vb_q2   | 0.000257 |
| vb_q3   | 0.000982 |
----------------------
[2024-01-25 14:49:29,075] [INFO] [logging.py:96:log_dist] [Rank 0] step=200, skipped=0, lr=[5.000000000000005e-07], mom=[(0.9, 0.999)]
[2024-01-25 14:49:29,075] [INFO] [timer.py:260:stop] epoch=0/micro_step=200/global_step=200, RunningAvgSamplesPerSec=267.75769433621144, CurrSamplesPerSec=270.7954382442991, MemAllocated=0.53GB, MaxMemAllocated=6.89GB
