
Lmod is automatically replacing "PrgEnv-cray/8.3.3" with "PrgEnv-amd/8.3.3".


Lmod is automatically replacing "cce/15.0.0" with "amd/5.6.0".


Due to MODULEPATH changes, the following have been reloaded:
  1) cray-mpich/8.1.23

srun -n 2 python image_train.py --image_size 32 --num_channels 128 --num_res_blocks 3 --learn_sigma True --dropout 0.3 --diffusion_steps 4000 --noise_schedule cosine --lr 1e-4 --batch_size 64
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
[W socket.cpp:436] [c10d] The server socket cannot be initialized on [::]:42045 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02014.hsn.cm.frontier.olcf.ornl.gov]:42045 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02014.hsn.cm.frontier.olcf.ornl.gov]:42045 (errno: 97 - Address family not supported by protocol).
Logging to /tmp/openai-2024-01-25-15-00-52-551487
creating model and diffusion...
creating data loader...
training...
------------------------
| grad_norm | 4.75     |
| loss      | 1.02     |
| loss_q0   | 1.01     |
| loss_q1   | 1.01     |
| loss_q2   | 1.01     |
| loss_q3   | 1.04     |
| mse       | 1        |
| mse_q0    | 0.999    |
| mse_q1    | 1.01     |
| mse_q2    | 1.01     |
| mse_q3    | 1        |
| samples   | 128      |
| step      | 0        |
| vb        | 0.0184   |
| vb_q0     | 0.014    |
| vb_q1     | 0.00523  |
| vb_q2     | 0.00506  |
| vb_q3     | 0.0424   |
------------------------
------------------------
| grad_norm | 4.49     |
| loss      | 0.893    |
| loss_q0   | 0.961    |
| loss_q1   | 0.874    |
| loss_q2   | 0.859    |
| loss_q3   | 0.881    |
| mse       | 0.875    |
| mse_q0    | 0.92     |
| mse_q1    | 0.87     |
| mse_q2    | 0.855    |
| mse_q3    | 0.855    |
| samples   | 1.41e+03 |
| step      | 10       |
| vb        | 0.0188   |
| vb_q0     | 0.0409   |
| vb_q1     | 0.00432  |
| vb_q2     | 0.00429  |
| vb_q3     | 0.0257   |
------------------------
------------------------
| grad_norm | 4.04     |
| loss      | 0.656    |
| loss_q0   | 0.77     |
| loss_q1   | 0.625    |
| loss_q2   | 0.603    |
| loss_q3   | 0.622    |
| mse       | 0.645    |
| mse_q0    | 0.745    |
| mse_q1    | 0.622    |
| mse_q2    | 0.6      |
| mse_q3    | 0.608    |
| samples   | 2.69e+03 |
| step      | 20       |
| vb        | 0.0109   |
| vb_q0     | 0.0244   |
| vb_q1     | 0.00311  |
| vb_q2     | 0.00301  |
| vb_q3     | 0.0131   |
------------------------
------------------------
| grad_norm | 3.2      |
| loss      | 0.46     |
| loss_q0   | 0.578    |
| loss_q1   | 0.418    |
| loss_q2   | 0.402    |
| loss_q3   | 0.427    |
| mse       | 0.447    |
| mse_q0    | 0.56     |
| mse_q1    | 0.416    |
| mse_q2    | 0.4      |
| mse_q3    | 0.396    |
| samples   | 3.97e+03 |
| step      | 30       |
| vb        | 0.0133   |
| vb_q0     | 0.0175   |
| vb_q1     | 0.00209  |
| vb_q2     | 0.00201  |
| vb_q3     | 0.0306   |
------------------------
------------------------
| grad_norm | 2.4      |
| loss      | 0.312    |
| loss_q0   | 0.486    |
| loss_q1   | 0.281    |
| loss_q2   | 0.258    |
| loss_q3   | 0.262    |
| mse       | 0.302    |
| mse_q0    | 0.451    |
| mse_q1    | 0.28     |
| mse_q2    | 0.256    |
| mse_q3    | 0.254    |
| samples   | 5.25e+03 |
| step      | 40       |
| vb        | 0.00999  |
| vb_q0     | 0.0349   |
| vb_q1     | 0.00142  |
| vb_q2     | 0.00129  |
| vb_q3     | 0.00779  |
------------------------
------------------------
| grad_norm | 1.71     |
| loss      | 0.231    |
| loss_q0   | 0.408    |
| loss_q1   | 0.187    |
| loss_q2   | 0.167    |
| loss_q3   | 0.166    |
| mse       | 0.225    |
| mse_q0    | 0.389    |
| mse_q1    | 0.186    |
| mse_q2    | 0.166    |
| mse_q3    | 0.16     |
| samples   | 6.53e+03 |
| step      | 50       |
| vb        | 0.0064   |
| vb_q0     | 0.0186   |
| vb_q1     | 0.000937 |
| vb_q2     | 0.00083  |
| vb_q3     | 0.0054   |
------------------------
------------------------
| grad_norm | 1.25     |
| loss      | 0.182    |
| loss_q0   | 0.364    |
| loss_q1   | 0.14     |
| loss_q2   | 0.113    |
| loss_q3   | 0.105    |
| mse       | 0.177    |
| mse_q0    | 0.35     |
| mse_q1    | 0.139    |
| mse_q2    | 0.112    |
| mse_q3    | 0.102    |
| samples   | 7.81e+03 |
| step      | 60       |
| vb        | 0.0048   |
| vb_q0     | 0.0141   |
| vb_q1     | 0.000709 |
| vb_q2     | 0.000569 |
| vb_q3     | 0.00349  |
------------------------
------------------------
| grad_norm | 0.884    |
| loss      | 0.145    |
| loss_q0   | 0.32     |
| loss_q1   | 0.109    |
| loss_q2   | 0.0802   |
| loss_q3   | 0.0707   |
| mse       | 0.141    |
| mse_q0    | 0.306    |
| mse_q1    | 0.109    |
| mse_q2    | 0.0798   |
| mse_q3    | 0.069    |
| samples   | 9.09e+03 |
| step      | 70       |
| vb        | 0.00408  |
| vb_q0     | 0.0139   |
| vb_q1     | 0.000554 |
| vb_q2     | 0.000402 |
| vb_q3     | 0.00168  |
------------------------
------------------------
| grad_norm | 0.648    |
| loss      | 0.149    |
| loss_q0   | 0.375    |
| loss_q1   | 0.0978   |
| loss_q2   | 0.0629   |
| loss_q3   | 0.0505   |
| mse       | 0.137    |
| mse_q0    | 0.333    |
| mse_q1    | 0.0973   |
| mse_q2    | 0.0626   |
| mse_q3    | 0.0485   |
| samples   | 1.04e+04 |
| step      | 80       |
| vb        | 0.0115   |
| vb_q0     | 0.0414   |
| vb_q1     | 0.000505 |
| vb_q2     | 0.000316 |
| vb_q3     | 0.002    |
------------------------
------------------------
| grad_norm | 0.658    |
| loss      | 0.314    |
| loss_q0   | 0.321    |
| loss_q1   | 0.0899   |
| loss_q2   | 0.0534   |
| loss_q3   | 0.753    |
| mse       | 0.121    |
| mse_q0    | 0.293    |
| mse_q1    | 0.0894   |
| mse_q2    | 0.0531   |
| mse_q3    | 0.0382   |
| samples   | 1.16e+04 |
| step      | 90       |
| vb        | 0.193    |
| vb_q0     | 0.0281   |
| vb_q1     | 0.000459 |
| vb_q2     | 0.000268 |
| vb_q3     | 0.715    |
------------------------
------------------------
| grad_norm | 0.603    |
| loss      | 0.112    |
| loss_q0   | 0.296    |
| loss_q1   | 0.0878   |
| loss_q2   | 0.0487   |
| loss_q3   | 0.034    |
| mse       | 0.108    |
| mse_q0    | 0.284    |
| mse_q1    | 0.0873   |
| mse_q2    | 0.0485   |
| mse_q3    | 0.0334   |
| samples   | 1.29e+04 |
| step      | 100      |
| vb        | 0.00317  |
| vb_q0     | 0.0123   |
| vb_q1     | 0.000454 |
| vb_q2     | 0.000243 |
| vb_q3     | 0.000673 |
------------------------
------------------------
| grad_norm | 0.487    |
| loss      | 0.116    |
| loss_q0   | 0.292    |
| loss_q1   | 0.085    |
| loss_q2   | 0.0464   |
| loss_q3   | 0.0303   |
| mse       | 0.112    |
| mse_q0    | 0.281    |
| mse_q1    | 0.0845   |
| mse_q2    | 0.0462   |
| mse_q3    | 0.0292   |
| samples   | 1.42e+04 |
| step      | 110      |
| vb        | 0.00322  |
| vb_q0     | 0.011    |
| vb_q1     | 0.000439 |
| vb_q2     | 0.000231 |
| vb_q3     | 0.0011   |
------------------------
------------------------
| grad_norm | 0.448    |
| loss      | 0.131    |
| loss_q0   | 0.37     |
| loss_q1   | 0.0824   |
| loss_q2   | 0.0436   |
| loss_q3   | 0.028    |
| mse       | 0.114    |
| mse_q0    | 0.307    |
| mse_q1    | 0.082    |
| mse_q2    | 0.0433   |
| mse_q3    | 0.0269   |
| samples   | 1.55e+04 |
| step      | 120      |
| vb        | 0.0162   |
| vb_q0     | 0.0634   |
| vb_q1     | 0.000423 |
| vb_q2     | 0.000215 |
| vb_q3     | 0.0011   |
------------------------
------------------------
| grad_norm | 0.307    |
| loss      | 0.119    |
| loss_q0   | 0.327    |
| loss_q1   | 0.0799   |
| loss_q2   | 0.0424   |
| loss_q3   | 0.0261   |
| mse       | 0.109    |
| mse_q0    | 0.289    |
| mse_q1    | 0.0795   |
| mse_q2    | 0.0422   |
| mse_q3    | 0.0251   |
| samples   | 1.68e+04 |
| step      | 130      |
| vb        | 0.0099   |
| vb_q0     | 0.0378   |
| vb_q1     | 0.000402 |
| vb_q2     | 0.000208 |
| vb_q3     | 0.000943 |
------------------------
------------------------
| grad_norm | 0.291    |
| loss      | 0.204    |
| loss_q0   | 0.278    |
| loss_q1   | 0.0788   |
| loss_q2   | 0.0401   |
| loss_q3   | 0.512    |
| mse       | 0.104    |
| mse_q0    | 0.262    |
| mse_q1    | 0.0784   |
| mse_q2    | 0.0398   |
| mse_q3    | 0.0247   |
| samples   | 1.8e+04  |
| step      | 140      |
| vb        | 0.0993   |
| vb_q0     | 0.0156   |
| vb_q1     | 0.000407 |
| vb_q2     | 0.000201 |
| vb_q3     | 0.487    |
------------------------
------------------------
| grad_norm | 0.33     |
| loss      | 0.114    |
| loss_q0   | 0.313    |
| loss_q1   | 0.0745   |
| loss_q2   | 0.0415   |
| loss_q3   | 0.0241   |
| mse       | 0.109    |
| mse_q0    | 0.295    |
| mse_q1    | 0.0741   |
| mse_q2    | 0.0413   |
| mse_q3    | 0.0233   |
| samples   | 1.93e+04 |
| step      | 150      |
| vb        | 0.00488  |
| vb_q0     | 0.018    |
| vb_q1     | 0.000375 |
| vb_q2     | 0.000205 |
| vb_q3     | 0.000816 |
------------------------
------------------------
| grad_norm | 0.242    |
| loss      | 0.119    |
| loss_q0   | 0.321    |
| loss_q1   | 0.0791   |
| loss_q2   | 0.0408   |
| loss_q3   | 0.0224   |
| mse       | 0.109    |
| mse_q0    | 0.286    |
| mse_q1    | 0.0786   |
| mse_q2    | 0.0406   |
| mse_q3    | 0.0217   |
| samples   | 2.06e+04 |
| step      | 160      |
| vb        | 0.00956  |
| vb_q0     | 0.0356   |
| vb_q1     | 0.000404 |
| vb_q2     | 0.000202 |
| vb_q3     | 0.000721 |
------------------------
------------------------
| grad_norm | 0.254    |
| loss      | 0.0976   |
| loss_q0   | 0.284    |
| loss_q1   | 0.0734   |
| loss_q2   | 0.0395   |
| loss_q3   | 0.0236   |
| mse       | 0.0942   |
| mse_q0    | 0.269    |
| mse_q1    | 0.073    |
| mse_q2    | 0.0393   |
| mse_q3    | 0.023    |
| samples   | 2.19e+04 |
| step      | 170      |
| vb        | 0.00341  |
| vb_q0     | 0.0145   |
| vb_q1     | 0.000376 |
| vb_q2     | 0.000199 |
| vb_q3     | 0.000645 |
------------------------
------------------------
| grad_norm | 0.214    |
| loss      | 0.113    |
| loss_q0   | 0.285    |
| loss_q1   | 0.0747   |
| loss_q2   | 0.0378   |
| loss_q3   | 0.0227   |
| mse       | 0.109    |
| mse_q0    | 0.271    |
| mse_q1    | 0.0743   |
| mse_q2    | 0.0377   |
| mse_q3    | 0.0223   |
| samples   | 2.32e+04 |
| step      | 180      |
| vb        | 0.00396  |
| vb_q0     | 0.0133   |
| vb_q1     | 0.000383 |
| vb_q2     | 0.00019  |
| vb_q3     | 0.000375 |
------------------------
------------------------
| grad_norm | 0.225    |
| loss      | 0.188    |
| loss_q0   | 0.27     |
| loss_q1   | 0.0772   |
| loss_q2   | 0.0381   |
| loss_q3   | 0.371    |
| mse       | 0.0968   |
| mse_q0    | 0.245    |
| mse_q1    | 0.0769   |
| mse_q2    | 0.0379   |
| mse_q3    | 0.0212   |
| samples   | 2.44e+04 |
| step      | 190      |
| vb        | 0.0915   |
| vb_q0     | 0.0254   |
| vb_q1     | 0.000394 |
| vb_q2     | 0.000191 |
| vb_q3     | 0.35     |
------------------------
