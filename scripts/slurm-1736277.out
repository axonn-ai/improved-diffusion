
Lmod is automatically replacing "PrgEnv-cray/8.3.3" with "PrgEnv-amd/8.3.3".


Lmod is automatically replacing "cce/15.0.0" with "amd/5.6.0".


Due to MODULEPATH changes, the following have been reloaded:
  1) cray-mpich/8.1.23

srun -n 64 python image_train.py --image_size 32 --num_channels 416 --num_res_blocks 3 --learn_sigma True --dropout 0.3 --diffusion_steps 4000 --noise_schedule cosine --lr 0.00005547001 --batch_size 32
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
[W socket.cpp:436] [c10d] The server socket cannot be initialized on [::]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier07847.hsn.cm.frontier.olcf.ornl.gov]:32923 (errno: 97 - Address family not supported by protocol).
Logging to /tmp/openai-2024-03-07-16-54-32-507636
creating model and diffusion...
creating data loader...
training...
MIOpen(HIP): Warning [PlainTextDb] Unable to create a directory: "/tmp/my-miopen-cache"
MIOpen(HIP): Warning [PlainTextDb] Unable to create a directory: "/tmp/my-miopen-cache"
MIOpen(HIP): Warning [PlainTextDb] Unable to create a directory: "/tmp/my-miopen-cache"
MIOpen(HIP): Warning [PlainTextDb] Unable to create a directory: "/tmp/my-miopen-cache"
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
Traceback (most recent call last):
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
Traceback (most recent call last):
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    TrainLoop(
    main()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    TrainLoop(
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    main()
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    main()
    self.run_step(batch, cond, losses)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    self.run_step(batch, cond, losses)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    self.run_step(batch, cond, losses)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.run_step(batch, cond, losses)
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
    return self._call_impl(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
Traceback (most recent call last):
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    losses = compute_losses()
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    main()
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    output = self._fsdp_wrapped_module(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    TrainLoop(
    return self._call_impl(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    TrainLoop(
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    h = module(h, emb)
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.run_step(batch, cond, losses)
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    self.forward_backward(batch, cond, losses)
    main()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    h = module(h, emb)
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    losses = compute_losses()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    main()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return forward_call(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.forward_backward(batch, cond, losses)
    self.run_step(batch, cond, losses)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    x = layer(x)
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    x = layer(x)
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    losses = compute_losses()
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    main()
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    output = self._fsdp_wrapped_module(*args, **kwargs)
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return self.model(x, new_ts, **kwargs)
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    self.forward_backward(batch, cond, losses)
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return forward_call(*args, **kwargs)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return self._call_impl(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self.model(x, new_ts, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
    return self.model(x, new_ts, **kwargs)
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    output = self._fsdp_wrapped_module(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    main()
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return self._call_impl(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
TypeError: forward() missing 1 required positional argument: 'emb'
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
    TrainLoop(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    main()
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    TrainLoop(
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
    h = module(h, emb)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    h = module(h, emb)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    self.forward_backward(batch, cond, losses)
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    main()
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    x = layer(x)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    return self.model(x, new_ts, **kwargs)
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
Traceback (most recent call last):
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    main()
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    output = self._fsdp_wrapped_module(*args, **kwargs)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    TrainLoop(
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    main()
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return forward_call(*args, **kwargs)
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    self.run_step(batch, cond, losses)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    losses = compute_losses()
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
    return self.model(x, new_ts, **kwargs)
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return self._call_impl(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    x = layer(x)
    x = layer(x)
    x = layer(x)
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    output = self._fsdp_wrapped_module(*args, **kwargs)
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    main()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    output = self._fsdp_wrapped_module(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
TypeError: forward() missing 1 required positional argument: 'emb'
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 103, in <module>
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 61, in main
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 176, in run_loop
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 200, in run_step
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 228, in forward_backward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 484, in forward
    h = module(h, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
    return forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 46, in forward
    x = layer(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 839, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: forward() missing 1 required positional argument: 'emb'
srun: error: frontier08152: tasks 17-20,22: Exited with exit code 1
srun: Terminating StepId=1736277.0
srun: error: frontier08151: task 11: Exited with exit code 1
srun: error: frontier07847: tasks 1,3-4,6: Exited with exit code 1
srun: error: frontier10328: tasks 51,54: Exited with exit code 1
slurmstepd: error: *** STEP 1736277.0 ON frontier07847 CANCELLED AT 2024-03-07T16:55:09 ***
srun: error: frontier08287: tasks 25-28,30: Exited with exit code 1
srun: error: frontier08410: tasks 40-47: Exited with exit code 1
srun: error: frontier07847: tasks 0,2,5,7: Exited with exit code 1
srun: error: frontier08151: tasks 8-10,12-15: Exited with exit code 1
srun: error: frontier10328: tasks 48-50,52-53,55: Exited with exit code 1
srun: error: frontier08403: tasks 32-39: Exited with exit code 1
srun: error: frontier08152: tasks 16,21,23: Exited with exit code 1
srun: error: frontier10333: tasks 56-63: Exited with exit code 1
srun: error: frontier08287: tasks 24,29,31: Exited with exit code 1
