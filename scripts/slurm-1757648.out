
Lmod is automatically replacing "PrgEnv-cray/8.3.3" with "PrgEnv-amd/8.3.3".


Lmod is automatically replacing "cce/15.0.0" with "amd/5.6.0".


Due to MODULEPATH changes, the following have been reloaded:
  1) cray-mpich/8.1.23

srun -n 32 python image_train.py --image_size 32 --num_channels 1600 --num_res_blocks 3 --learn_sigma True --dropout 0.3 --diffusion_steps 4000 --noise_schedule cosine --lr 0.00005547001 --batch_size 64 --deepspeed_config ./temp32.json
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
amdgpu.ids: No such file or directory
[2024-03-13 17:18:02,987] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,987] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,987] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,987] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,987] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,987] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,987] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,987] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:02,988] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,002] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,002] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,002] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,002] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,002] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,002] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,002] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,002] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,220] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,220] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,220] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,220] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,220] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,220] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,220] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:03,220] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,539] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,670] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,670] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,670] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,670] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,670] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,670] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,670] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,670] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,670] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,670] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,670] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,670] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,670] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,670] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,670] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,670] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,829] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,829] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,829] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,829] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,829] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,829] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,829] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,829] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,829] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,829] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,829] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,829] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-13 17:18:04,829] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,829] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,829] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,829] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=1, local_rank=1, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=2, local_rank=2, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,830] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=8, local_rank=0, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=24, local_rank=0, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=16, local_rank=0, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=3, local_rank=3, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=17, local_rank=1, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=4, local_rank=4, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=18, local_rank=2, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=5, local_rank=5, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=19, local_rank=3, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=6, local_rank=6, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=21, local_rank=5, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=7, local_rank=7, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=22, local_rank=6, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=20, local_rank=4, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=23, local_rank=7, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,830] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=9, local_rank=1, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,830] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=10, local_rank=2, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,830] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=11, local_rank=3, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,830] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=12, local_rank=4, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,830] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=13, local_rank=5, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,830] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=14, local_rank=6, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,830] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=15, local_rank=7, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=25, local_rank=1, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=26, local_rank=2, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=27, local_rank=3, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=28, local_rank=4, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=29, local_rank=5, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=30, local_rank=6, world_size=32, master_addr=100.64.149.16, master_port=29500
[2024-03-13 17:18:04,831] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=31, local_rank=7, world_size=32, master_addr=100.64.149.16, master_port=29500
[W socket.cpp:436] [c10d] The server socket cannot be initialized on [::]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:663] [c10d] The client socket cannot be initialized to connect to [frontier02704.hostmgmt2109.cm.frontier.olcf.ornl.gov]:29500 (errno: 97 - Address family not supported by protocol).
Logging to /tmp/openai-2024-03-13-17-18-04-897639
initialized deepspeed
creating model and diffusion...
creating data loader...
[2024-03-13 17:18:52,103] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.13.1, git-hash=unknown, git-branch=unknown
[2024-03-13 17:18:54,983] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-03-13 17:18:55,000] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-03-13 17:18:55,000] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-03-13 17:18:55,045] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2024-03-13 17:18:55,046] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2024-03-13 17:18:55,046] [INFO] [logging.py:96:log_dist] [Rank 0] Creating fp16 ZeRO stage 3 optimizer, MiCS is enabled False, Hierarchical params gather False
[2024-03-13 17:18:55,046] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.float32 ZeRO stage 3 optimizer
[2024-03-13 17:18:55,189] [INFO] [utils.py:791:see_memory_usage] Stage 3 initialize beginning
[2024-03-13 17:18:55,211] [INFO] [utils.py:792:see_memory_usage] MA 30.59 GB         Max_MA 30.59 GB         CA 30.67 GB         Max_CA 31 GB 
[2024-03-13 17:18:55,212] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.07 GB, percent = 6.2%
[2024-03-13 17:18:55,214] [INFO] [stage3.py:128:__init__] Reduce bucket size 500,000,000
[2024-03-13 17:18:55,214] [INFO] [stage3.py:129:__init__] Prefetch bucket size 50,000,000
[2024-03-13 17:18:55,327] [INFO] [utils.py:791:see_memory_usage] DeepSpeedZeRoOffload initialize [begin]
[2024-03-13 17:18:55,328] [INFO] [utils.py:792:see_memory_usage] MA 30.59 GB         Max_MA 30.59 GB         CA 30.67 GB         Max_CA 31 GB 
[2024-03-13 17:18:55,328] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 30.96 GB, percent = 6.2%
Parameter Offload: Total persistent parameters: 1265606 in 301 params
[2024-03-13 17:18:58,825] [INFO] [utils.py:791:see_memory_usage] DeepSpeedZeRoOffload initialize [end]
[2024-03-13 17:18:58,826] [INFO] [utils.py:792:see_memory_usage] MA 0.96 GB         Max_MA 30.59 GB         CA 31.11 GB         Max_CA 31 GB 
[2024-03-13 17:18:58,826] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.19 GB, percent = 6.2%
[2024-03-13 17:18:59,137] [INFO] [utils.py:791:see_memory_usage] Before creating fp16 partitions
[2024-03-13 17:18:59,138] [INFO] [utils.py:792:see_memory_usage] MA 0.96 GB         Max_MA 0.96 GB         CA 31.11 GB         Max_CA 31 GB 
[2024-03-13 17:18:59,138] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.19 GB, percent = 6.2%
[2024-03-13 17:19:07,270] [INFO] [utils.py:791:see_memory_usage] After creating fp16 partitions: 1
[2024-03-13 17:19:07,271] [INFO] [utils.py:792:see_memory_usage] MA 0.96 GB         Max_MA 0.96 GB         CA 0.96 GB         Max_CA 31 GB 
[2024-03-13 17:19:07,271] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.27 GB, percent = 6.2%
[2024-03-13 17:19:07,328] [INFO] [utils.py:791:see_memory_usage] Before creating fp32 partitions
[2024-03-13 17:19:07,329] [INFO] [utils.py:792:see_memory_usage] MA 0.96 GB         Max_MA 0.96 GB         CA 0.96 GB         Max_CA 1 GB 
[2024-03-13 17:19:07,329] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.27 GB, percent = 6.2%
[2024-03-13 17:19:07,384] [INFO] [utils.py:791:see_memory_usage] After creating fp32 partitions
[2024-03-13 17:19:07,385] [INFO] [utils.py:792:see_memory_usage] MA 1.91 GB         Max_MA 1.91 GB         CA 1.91 GB         Max_CA 2 GB 
[2024-03-13 17:19:07,385] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.27 GB, percent = 6.2%
[2024-03-13 17:19:07,441] [INFO] [utils.py:791:see_memory_usage] Before initializing optimizer states
[2024-03-13 17:19:07,441] [INFO] [utils.py:792:see_memory_usage] MA 1.91 GB         Max_MA 1.91 GB         CA 1.91 GB         Max_CA 2 GB 
[2024-03-13 17:19:07,442] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.28 GB, percent = 6.2%
[2024-03-13 17:19:08,089] [INFO] [utils.py:791:see_memory_usage] After initializing optimizer states
[2024-03-13 17:19:08,090] [INFO] [utils.py:792:see_memory_usage] MA 3.82 GB         Max_MA 5.73 GB         CA 5.73 GB         Max_CA 6 GB 
[2024-03-13 17:19:08,090] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.34 GB, percent = 6.2%
[2024-03-13 17:19:08,091] [INFO] [stage3.py:482:_setup_for_real_optimizer] optimizer state initialized
[2024-03-13 17:19:09,594] [INFO] [utils.py:791:see_memory_usage] After initializing ZeRO optimizer
[2024-03-13 17:19:09,595] [INFO] [utils.py:792:see_memory_usage] MA 6.64 GB         Max_MA 8.01 GB         CA 18.06 GB         Max_CA 18 GB 
[2024-03-13 17:19:09,595] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 31.39 GB, percent = 6.2%
[2024-03-13 17:19:09,595] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2024-03-13 17:19:09,595] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-03-13 17:19:09,595] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-03-13 17:19:09,595] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[5.547001e-05], mom=[(0.9, 0.999)]
[2024-03-13 17:19:09,606] [INFO] [config.py:984:print] DeepSpeedEngine configuration:
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   amp_enabled .................. False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   amp_params ................... False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   bfloat16_enabled ............. False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   checkpoint_parallel_write_pipeline  False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   checkpoint_tag_validation_enabled  True
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   checkpoint_tag_validation_fail  False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7ff6580b4250>
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   communication_data_type ...... None
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   curriculum_enabled_legacy .... False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   curriculum_params_legacy ..... False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   data_efficiency_enabled ...... False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   dataloader_drop_last ......... False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   disable_allgather ............ False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   dump_state ................... False
[2024-03-13 17:19:09,606] [INFO] [config.py:988:print]   dynamic_loss_scale_args ...... None
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   eigenvalue_enabled ........... False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   eigenvalue_gas_boundary_resolution  1
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   eigenvalue_layer_num ......... 0
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   eigenvalue_max_iter .......... 100
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   eigenvalue_stability ......... 1e-06
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   eigenvalue_tol ............... 0.01
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   eigenvalue_verbose ........... False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   elasticity_enabled ........... False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   fp16_auto_cast ............... None
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   fp16_enabled ................. False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   fp16_master_weights_and_gradients  False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   global_rank .................. 0
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   grad_accum_dtype ............. None
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   gradient_accumulation_steps .. 1
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   gradient_clipping ............ 0.0
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   gradient_predivide_factor .... 1.0
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   graph_harvesting ............. False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   initial_dynamic_scale ........ 65536
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   load_universal_checkpoint .... False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   loss_scale ................... 0
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   memory_breakdown ............. False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   mics_hierarchial_params_gather  False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   mics_shard_size .............. -1
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   optimizer_legacy_fusion ...... False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   optimizer_name ............... None
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   optimizer_params ............. None
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   pld_enabled .................. False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   pld_params ................... False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   prescale_gradients ........... False
[2024-03-13 17:19:09,607] [INFO] [config.py:988:print]   scheduler_name ............... None
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   scheduler_params ............. None
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   seq_parallel_communication_data_type  torch.float32
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   sparse_attention ............. None
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   sparse_gradients_enabled ..... False
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   steps_per_print .............. 1
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   train_batch_size ............. 2048
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   train_micro_batch_size_per_gpu  64
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   use_data_before_expert_parallel_  False
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   use_node_local_storage ....... False
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   wall_clock_breakdown ......... False
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   weight_quantization_config ... None
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   world_size ................... 32
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   zero_allow_untested_optimizer  False
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   zero_config .................. stage=3 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   zero_enabled ................. True
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   zero_force_ds_cpu_optimizer .. True
[2024-03-13 17:19:09,608] [INFO] [config.py:988:print]   zero_optimization_stage ...... 3
[2024-03-13 17:19:09,608] [INFO] [config.py:974:print_user_config]   json = {
    "train_batch_size": 2.048000e+03, 
    "train_micro_batch_size_per_gpu": 64, 
    "zero_optimization": {
        "stage": 3
    }, 
    "steps_per_print": 1, 
    "overlap_comm": true
}
training...
MIOpen(HIP): Warning [PlainTextDb] Unable to create a directory: "/tmp/my-miopen-cache"
MIOpen(HIP): Warning [PlainTextDb] Unable to create a directory: "/tmp/my-miopen-cache"
MIOpen(HIP): Warning [PlainTextDb] Unable to create a directory: "/tmp/my-miopen-cache"
MIOpen(HIP): Warning [PlainTextDb] Unable to create a directory: "/tmp/my-miopen-cache"
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    TrainLoop(
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    self.forward_backward(batch, cond, losses)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    return func(*inputs)
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    loss = self.module(*inputs, **kwargs)
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    h = self.in_layers(x)
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    main()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    ret_val = func(*args, **kwargs)
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return super().forward(x.float()).type(x.dtype)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 400.00 MiB. GPU 5 has a total capacty of 63.98 GiB of which 460.00 MiB is free. Of the allocated memory 61.95 GiB is allocated by PyTorch, and 292.15 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 6 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
Traceback (most recent call last):
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
Traceback (most recent call last):
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
Traceback (most recent call last):
Traceback (most recent call last):
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    TrainLoop(
    main()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 3 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 1 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    ret_val = func(*args, **kwargs)
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
Traceback (most recent call last):
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    self.run_step(batch, cond, losses)
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
Traceback (most recent call last):
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return func(*inputs)
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 4 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    self.forward_backward(batch, cond, losses)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    losses = compute_losses()
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    result = forward_call(*args, **kwargs)
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
Traceback (most recent call last):
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return self.model(x, new_ts, **kwargs)
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    input = module(input)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().forward(x.float()).type(x.dtype)
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    input = module(input)
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
Traceback (most recent call last):
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 6 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 5 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    self.forward_backward(batch, cond, losses)
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return super().forward(x.float()).type(x.dtype)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    losses = compute_losses()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return func(*inputs)
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
Traceback (most recent call last):
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 2 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 5 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 0 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    main()
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 1 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    input = module(input)
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 4 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    return super().forward(x.float()).type(x.dtype)
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 7 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return F.group_norm(
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 1 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 7 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    main()
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 2 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    loss = self.module(*inputs, **kwargs)
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
Traceback (most recent call last):
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    x = layer(x, emb)
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
Traceback (most recent call last):
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 3 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 6 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 4 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 7 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 5 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    result = forward_call(*args, **kwargs)
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 4 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 0 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 3 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 1 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 2 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
Traceback (most recent call last):
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 3 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 7 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 2 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 454.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 0 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
Traceback (most recent call last):
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 114, in <module>
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    main()
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/improved-diffusion/scripts/image_train.py", line 72, in main
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    TrainLoop(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 186, in run_loop
    self.run_step(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 224, in run_step
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    self.forward_backward(batch, cond, losses)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/train_util.py", line 256, in forward_backward
    losses = compute_losses()
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 96, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/gaussian_diffusion.py", line 710, in training_losses
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/respace.py", line 122, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/utils/nvtx.py", line 15, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/deepspeed/runtime/engine.py", line 1842, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    loss = self.module(*inputs, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 489, in forward
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    h = module(cat_in, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 44, in forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    x = layer(x, emb)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 180, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return checkpoint(
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 139, in checkpoint
    return func(*inputs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/unet.py", line 185, in _forward
    h = self.in_layers(x)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    result = forward_call(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 6 has a total capacty of 63.98 GiB of which 908.00 MiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
    result = forward_call(*args, **kwargs)
  File "/ccs/home/adityaranjan/scratch/my-venv/improved-diffusion/improved_diffusion/nn.py", line 19, in forward
    return super().forward(x.float()).type(x.dtype)
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/modules/normalization.py", line 279, in forward
    return F.group_norm(
  File "/lustre/orion/csc547/scratch/adityaranjan/my-venv/lib/python3.9/site-packages/torch/nn/functional.py", line 2558, in group_norm
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
torch.cuda.OutOfMemoryError: HIP out of memory. Tried to allocate 800.00 MiB. GPU 0 has a total capacty of 63.98 GiB of which 1.07 GiB is free. Of the allocated memory 61.16 GiB is allocated by PyTorch, and 455.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_HIP_ALLOC_CONF
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 1757648.0 ON frontier02704 CANCELLED AT 2024-03-13T17:39:29 ***
slurmstepd: error: *** JOB 1757648 ON frontier02704 CANCELLED AT 2024-03-13T17:39:29 ***
